---
sidebar_position: 5
---

import useBaseUrl from '@docusaurus/useBaseUrl';

# 5. Post-deployment configurations

## Disable Legacy features

### Youtube Guide

<br />
<iframe
  width="560"
  height="315"
  src="https://www.youtube.com/embed/OfviJtqIL4g"
  title="Disable Legacy Features in Databricks Account Console"
  frameBorder="0"
  allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture"
  allowFullScreen
></iframe>

### Step-by-step guide

* Go to the Account Console
    - [AWS](https://accounts.cloud.databricks.com)
    - [Azure](https://accounts.azuredatabricks.net)
* On the left panel, click on **Settings**.
* Click on the **Feature enablement** tab.
* Disable Legacy Features.
    * Click on the drop-down and disable it.

<div className='bg-gray-100 p-4 rounded-lg mb-6'>
  <img src={useBaseUrl('/img/account-disable-features.png')} alt="Single-tenant Deployment"/>
</div>

## Add new users and groups

<br />
<iframe
  width="560"
  height="315"
  src="https://www.youtube.com/embed/1E4dis3cFlM"
  title="Add new groups to the Account"
  frameBorder="0"
  allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture"
  allowFullScreen
></iframe>

### UI approach (easy to start)

#### Users
Add coworkers and peers into Databricks.

* Go to the Account Console.
    - [AWS.](https://accounts.cloud.databricks.com)
    - [Azure.](https://accounts.azuredatabricks.net)
* On the left panel, click on **User management**.
* On the **Users** tab, click on **Add user**.
* Type the **email** and **user full name**.

#### Groups

:::info Starter groups
Start simple with the following groups:
- **metastore-admins** OR **unity-admins**.
    - Next section elaborates further.
- **data-engineers**.
- **data-consumers**.
- **dev-workspace-admins**.
    - create the admin group for every workspace (i.e staging and prod).
:::

* Go to the Account Console.
    - [AWS.](https://accounts.cloud.databricks.com)
    - [Azure.](https://accounts.azuredatabricks.net)
* On the left panel, click on **User management**.
* On the **Groups** tab, click on **Add group**.
    * Type the group name.
* Click on the created group.
* Click on **Add members**.
* Add the coworkers and peers from the previous steps.

### SCIM approach (best practice)

Configure SCIM user provisioning to sync your users from your identify provider into Databricks.

* [Sync users and groups from your identity provider using SCIM.
](https://docs.databricks.com/aws/en/admin/users-groups/scim/)
    * Select the cloud-provider at the top-right.
    * [Configure SCIM provisioning using Microsoft Entra ID (Azure Active Directory).
](https://docs.databricks.com/aws/en/admin/users-groups/scim/aad)
    * [Configure SCIM provisioning for Okta.
](https://docs.databricks.com/aws/en/admin/users-groups/scim/okta)
    * [Configure SCIM provisioning for OneLogin.
](https://docs.databricks.com/aws/en/admin/users-groups/scim/onelogin)
    * [Enable all identity provider users to access Databricks.
](https://docs.databricks.com/aws/en/admin/users-groups/scim/enable-all-users)


## Change Metastore owner

:::info 
- **The metastore owner should be a group.**
:::

:::danger 
- **Avoid ownership by individuals or service principals.**
:::

* Go to the Account Console
    - [AWS](https://accounts.cloud.databricks.com)
    - [Azure](https://accounts.azuredatabricks.net)
* On the left panel, click on **Catalog**.
* Click on the available metastore.
* **Verify that the metastore owner is a group**, not a user or the Terraform SP.
    * If the metastore Admin is an user or a Service Principal:
        * Go to **User Management** tab.
        * Create a new group named **unity-admins** or **metastore-admins**.
            * Add users (yourself and other team members) to the group.
        * Go back to **Catalog** and click on the metastore again.
        * Change the ownership: assign the new group.
* Select the metastore auto-assigment on new Workspaces.

<div className='bg-gray-100 p-4 rounded-lg mb-6'>
  <img src={useBaseUrl('/img/account-metastore-owner.png')} alt="Single-tenant Deployment"/>
</div>

## Change UC assets ownership

:::info 
- Similar as the previous section, all the UC assets should be owned by a group.
- Replace the current owners with the new **metastore-admins** or **unity-admins** group.
:::

### Step-by-step guide.

* Check the screenshots.
* On the workspace, go to **Catalog**.
* Click on External Data.
* For each tab (External Locations, Credentials, Connections, External Metadata), change the owner to the metastore Admin group.
    * Click on the asset, then click on the pencil icon next to the owners name.
    * There is going to be at most 3 storage locations and external locations.
        * **Note:** If the External Locations or Credentials tab is empty, probably you don't belong to the metastore Admins group. 
* Go to **Catalog**.
* For each catalog **that is not system catalog**, change the owner to the metastore Admin group.
    * For each schema in the catalog, change the owner to the metastore Admin group.

#### Screenshots for UC external data assets
<img src={useBaseUrl('/img/uc-owners-1.jpg')} alt="description"/>
<img src={useBaseUrl('/img/uc-owners-2.jpg')} alt="description"/>
<img src={useBaseUrl('/img/uc-owners-3.jpg')} alt="description"/>

#### Screenshot for UC catalog and schemas
<img src={useBaseUrl('/img/uc-owners-4.jpg')} alt="description"/>


* On External Data